<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºå•†ç¨æ£€æµ‹å™¨ v5.1 | æ¯’èˆŒäº¤äº’ç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #10B981;       /* ç†æ€§ç»¿ */
            --primary-dark: #059669;
            --bg-body: #F3F4F6;
            --bg-card: #FFFFFF;
            --text-main: #1F2937;
            --text-sub: #6B7280;
            --danger: #EF4444;        /* è­¦ç¤ºçº¢ */
            --warning: #F59E0B;
            --radius: 16px;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* === æ ¸å¿ƒå®¹å™¨ === */
        .quiz-container {
            width: 100%;
            max-width: 650px;
            background: var(--bg-card);
            border-radius: var(--radius);
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            padding: 30px;
            position: relative;
            z-index: 10;
            margin-bottom: 40px;
            border-top: 6px solid var(--primary);
            overflow: hidden;
        }

        h1 { color: var(--primary-dark); text-align: center; margin: 0 0 10px 0; }
        .subtitle { color: var(--text-sub); text-align: center; margin-bottom: 30px; font-size: 0.9rem; }

        /* è¾“å…¥æ¡† */
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9rem; }
        input, select {
            width: 100%; padding: 12px; border: 2px solid #E5E7EB; border-radius: 10px;
            font-size: 1rem; box-sizing: border-box; transition: 0.3s;
        }
        input:focus { border-color: var(--primary); outline: none; }

        /* æŒ‰é’® */
        .btn {
            width: 100%; padding: 15px; border: none; border-radius: 12px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); background: var(--primary-dark); }
        
        .btn-option {
            background: #fff; border: 2px solid #E5E7EB; color: var(--text-main);
            margin-bottom: 12px; text-align: left; padding: 16px; line-height: 1.5; font-weight: 500;
            justify-content: flex-start;
        }
        .btn-option:hover { border-color: var(--primary); background: #ECFDF5; color: var(--primary-dark); }

        /* çŸ¥è¯†å¡ç‰‡ (è¯¦æƒ…ä¸æ¡ˆä¾‹) */
        .knowledge-box {
            background: #F9FAFB;
            border-left: 4px solid #3B82F6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            font-size: 0.9rem;
            color: #4B5563;
        }
        .knowledge-summary {
            cursor: pointer;
            font-weight: 600;
            color: #2563EB;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 5px;
        }
        .knowledge-content {
            margin-top: 10px;
            line-height: 1.6;
            display: block; /* é»˜è®¤å±•å¼€ */
            animation: fadeIn 0.3s;
        }
        .knowledge-content.collapsed { display: none; } /* æŠ˜å çŠ¶æ€ */
        
        .case-tag {
            background: #E5E7EB; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; margin-right: 5px; color: #374151;
        }

        /* æ¯’èˆŒå¼¹çª— (Overlay) */
        .critique-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
            padding: 40px;
            box-sizing: border-box;
            text-align: center;
        }
        .critique-overlay.active { opacity: 1; pointer-events: all; }
        
        .critique-icon { font-size: 4rem; margin-bottom: 20px; animation: shake 0.5s; }
        .critique-title { font-size: 1.5rem; color: #FCA5A5; margin-bottom: 15px; font-weight: bold; }
        .critique-text { font-size: 1.1rem; line-height: 1.6; margin-bottom: 30px; color: #fff; font-style: italic; }
        
        .btn-ouch {
            background: transparent; border: 2px solid #fff; color: #fff; width: auto; padding: 10px 30px;
        }
        .btn-ouch:hover { background: #fff; color: #000; }

        @keyframes shake {
            0% { transform: rotate(0deg); } 25% { transform: rotate(5deg); } 
            50% { transform: rotate(0deg); } 75% { transform: rotate(-5deg); } 100% { transform: rotate(0deg); }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* è¿›åº¦æ¡ */
        .progress-container { height: 6px; background: #E5E7EB; border-radius: 3px; margin: 20px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.4s ease; }
        
        /* é¡µé¢åˆ‡æ¢ */
        .screen { display: none; opacity: 0; animation: fadeUp 0.5s forwards; }
        .screen.active { display: block; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* PDF éšè—åŒº */
        #pdf-content { display: none; }
        .pdf-visible { display: block !important; padding: 40px; background: white; color: black; }

        /* ç»“æœé¡µ */
        .score-display { font-size: 5rem; font-weight: 800; color: var(--primary); margin: 10px 0; line-height: 1; }
    </style>
</head>
<body>

<div class="quiz-container">
    
    <div id="screen-setup" class="screen active">
        <h1>ğŸ” æ™ºå•†ç¨æ£€æµ‹å™¨</h1>
        <p class="subtitle">è¡Œä¸ºç»æµå­¦ç‰ˆ Â· é»˜è®¤å¼€å¯ç†è®ºè¾…åŠ©</p>
        
        <div class="input-group">
            <label>ğŸ›ï¸ æƒ³ä¹°ä»€ä¹ˆï¼Ÿ</label>
            <input type="text" id="itemName" placeholder="ä¾‹å¦‚ï¼šSony A7M4">
        </div>
        <div class="input-group">
            <label>ğŸ’° ä»·æ ¼ (Â¥)</label>
            <input type="number" id="itemPrice" placeholder="8999">
        </div>
        <div class="input-group">
            <label>ğŸ’¼ æœˆè–ª (Â¥)</label>
            <input type="number" id="monthlySalary" placeholder="ç”¨äºè®¡ç®—ç”Ÿå‘½æ—¶é—´">
        </div>

        <button class="btn btn-primary" onclick="startGame()">å¼€å§‹æ‹·é—®</button>
    </div>

    <div id="screen-quiz" class="screen">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <span style="background:#E5E7EB; padding:4px 10px; border-radius:12px; font-size:0.8rem; font-weight:bold; color:#4B5563;" id="dimension-tag">ç»´åº¦ä¸€</span>
            <span style="color:#9CA3AF; font-size:0.9rem;">ç¬¬ <span id="current-q-num">1</span>/20 é¢˜</span>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <h3 id="question-text" style="font-size:1.2rem; margin-bottom:15px; min-height:50px;">é—®é¢˜åŠ è½½ä¸­...</h3>

        <div class="knowledge-box">
            <div class="knowledge-summary" onclick="toggleKnowledge()">
                <span><i class="fas fa-lightbulb"></i> å‚è€ƒç†è®ºä¸æ¡ˆä¾‹</span>
                <i class="fas fa-chevron-up" id="toggle-icon" style="font-size:0.8rem;"></i>
            </div>
            <div class="knowledge-content" id="knowledge-content">
                </div>
        </div>
        
        <div id="options-container">
            </div>

        <div id="critique-overlay" class="critique-overlay">
            <div class="critique-icon">ğŸ¤¡</div>
            <div class="critique-title">è­¦æŠ¥ï¼šæ™ºå•†ç¨é¢„è­¦</div>
            <div class="critique-text" id="overlay-text"></div>
            <button class="btn btn-ouch" onclick="closeCritique()">æ‰å¿ƒäº†ï¼Œä¸‹ä¸€é¢˜</button>
        </div>
    </div>

    <div id="screen-result" class="screen" style="text-align: center;">
        <p style="color:#6B7280; margin-bottom:0;">æœ€ç»ˆç†æ€§å¾—åˆ†</p>
        <div class="score-display" id="final-score">0</div>
        <h2 id="final-verdict"></h2>
        <div id="final-advice" style="background:#F9FAFB; padding:20px; border-radius:12px; text-align:left; margin-bottom:20px; font-size:0.95rem; line-height:1.6;"></div>
        
        <button class="btn btn-primary" onclick="downloadPDF()">ä¸‹è½½è¯¦ç»†å®¡è®¡æŠ¥å‘Š (PDF)</button>
        <button class="btn" style="background:transparent; color:#6B7280; margin-top:10px;" onclick="location.reload()">å†æµ‹ä¸€æ¬¡</button>
    </div>
</div>

<div style="max-width:500px; margin:0 auto; text-align:center; opacity:0.8;">
    <p style="font-size:0.85rem; color:#6B7280;">å¦‚æœè¿™ä¸ªå·¥å…·éª‚é†’äº†ä½ ï¼Œå¯ä»¥è¯·ä½œè€…å–æ¯å†°ç¾å¼ ğŸ‘‡</p>
    <div style="width:120px; height:120px; background:#ddd; margin:10px auto; display:flex; align-items:center; justify-content:center; border-radius:10px;">
        <i class="fas fa-qrcode" style="font-size:2rem; color:#999;"></i>
    </div>
</div>

<div id="pdf-content">
    <div style="border-bottom:4px solid #10B981; padding-bottom:20px; margin-bottom:20px;">
        <h1>æ¶ˆè´¹ç†æ€§å®¡è®¡æŠ¥å‘Š</h1>
        <p>Generated by æ™ºå•†ç¨æ£€æµ‹å™¨ v5.1</p>
    </div>
    <div style="background:#F3F4F6; padding:20px; border-radius:8px; margin-bottom:20px;">
        <p><strong>ğŸ“¦ å•†å“ï¼š</strong> <span id="pdf-item"></span></p>
        <p><strong>ğŸ’° ä»·æ ¼ï¼š</strong> Â¥<span id="pdf-price"></span></p>
        <p><strong>â³ åŠ³åŠ¨åŠ›å…‘æ¢ï¼š</strong> <span id="pdf-labor"></span> å°æ—¶</p>
        <p><strong>ğŸ† å¾—åˆ†ï¼š</strong> <span id="pdf-score" style="font-size:20px; font-weight:bold; color:#10B981;"></span> / 100</p>
    </div>
    <div style="border:1px solid #eee; padding:15px; margin-bottom:20px;">
        <h4 id="pdf-verdict-text"></h4>
        <p id="pdf-advice-text"></p>
    </div>
    <h3>çµé­‚æ‹·é—®è®°å½•ï¼š</h3>
    <table style="width:100%; border-collapse:collapse; font-size:12px;">
        <thead>
            <tr style="background:#10B981; color:white;">
                <th style="padding:8px;">ç»´åº¦</th>
                <th style="padding:8px;">é—®é¢˜</th>
                <th style="padding:8px;">ä½ çš„é€‰æ‹© & é”è¯„</th>
            </tr>
        </thead>
        <tbody id="pdf-table-body"></tbody>
    </table>
</div>

<script>
    // === æ•°æ®ä¸­å¿ƒ ===
    let state = { score: 0, currentQ: 0, answers: [], laborHours: 0 };
    
    // å®Œæ•´ 20 é¢˜åº“
    const questions = [
        // --- ç»´åº¦ä¸€ï¼šæ•ˆç”¨å®¡è®¡ ---
        {
            dim: "æ•ˆç”¨å®¡è®¡",
            q: "å¹»æƒ³è‡ªæˆ‘æµ‹è¯•ï¼šä½ ä¹°è¿™ä¸ªï¼Œæ˜¯ç»™â€˜ç°åœ¨çš„è‡ªå·±â€™ç”¨ï¼Œè¿˜æ˜¯ç»™â€˜æƒ³è±¡ä¸­ä¼šæˆä¸ºçš„äººâ€™ç”¨ï¼Ÿ",
            theory: "æ¶ˆè´¹è€…å¸¸é€šè¿‡è´­ä¹°äº§å“æ¥æ„å»ºç†æƒ³è‡ªæˆ‘ã€‚ä½†ç ”ç©¶è¡¨æ˜ï¼Œäº§å“æœ¬èº«æ— æ³•åˆ›é€ ä¹ æƒ¯ï¼Œåªèƒ½è¾…åŠ©å·²æœ‰çš„ä¹ æƒ¯ã€‚",
            case: "ç›¸æœº vs. æ‰‹æœºï¼šæƒ³ä¹°ç´¢å°¼A7M4ï¼Œä½†è¿‡å»ä¸€å¹´åªç”¨æ‰‹æœºæ‹äº†ä¸åˆ°50å¼ ç…§ç‰‡ã€‚ç›¸æœºä¹°æ¥åªä¼šç§¯ç°ã€‚",
            options: [
                { t: "A. ç°åœ¨çš„æˆ‘ï¼Œè¿™æ˜¯åˆšéœ€", s: 5 },
                { t: "B. ç†æƒ³çš„æˆ‘ï¼Œæˆ‘æƒ³æ•¦ä¿ƒè‡ªå·±æ”¹å˜", s: 0, critique: "èŠ±3ä¸‡å—ä¹°ç›¸æœºå¹¶ä¸èƒ½è®©ä½ å˜æˆæ‘„å½±å¸ˆï¼Œåªä¼šè®©ä½ å˜æˆä¸€ä¸ªâ€˜æ‹¥æœ‰æ˜‚è´µç›¸æœºçš„è·¯äººâ€™ã€‚è®¾å¤‡é•¿ä¸å‡ºæŠ€æœ¯ï¼Œæ›´é•¿ä¸å‡ºå‹¤å¥‹ã€‚" }
            ]
        },
        {
            dim: "æ•ˆç”¨å®¡è®¡",
            q: "æ›¿ä»£å“å£å’ï¼šä½ æ˜¯å¦å·²æœ‰èƒ½å®ç°80%åŠŸèƒ½çš„æ›¿ä»£å“ï¼Ÿä¸ºäº†è¿™20%æå‡ï¼Œå€¼å¾—å¤šèŠ±10å€é’±å—ï¼Ÿ",
            theory: "è¾¹é™…æ•ˆç”¨é€’å‡è§„å¾‹ã€‚ä»0åˆ°1çš„æå‡å·¨å¤§ï¼Œä½†ä»90åˆ†åˆ°95åˆ†çš„æå‡å¾€å¾€ä¼´éšç€æŒ‡æ•°çº§çš„æˆæœ¬å¢åŠ ã€‚",
            case: "iPad Pro vs æ—§iPadï¼šé™¤äº†è·‘åˆ†ï¼Œæ—¥å¸¸çœ‹å‰§è®°ç¬”è®°ä½“éªŒæ— å·®ã€‚è¿™å¤šèŠ±çš„8000å…ƒæ˜¯ä¸ºâ€˜æ€§èƒ½è¿‡å‰©â€™ä¹°å•ã€‚",
            options: [
                { t: "A. æ²¡æœ‰/æ—§çš„åäº†", s: 5 },
                { t: "B. æœ‰ï¼Œä½†æˆ‘æƒ³ä½“éªŒæå‡", s: 0, critique: "ä¸ºäº†é‚£ä¸ªåªæœ‰æ”¾å¤§400%æ‰èƒ½çœ‹å‡ºçš„å™ªç‚¹åŒºåˆ«å»ä¹°æ–°è®¾å¤‡ï¼Œé‚£æ˜¯å‚æ•°å…šçš„è‡ªæˆ‘é«˜æ½®ï¼Œä¸æ˜¯éœ€æ±‚ã€‚" }
            ]
        },
        {
            dim: "æ•ˆç”¨å®¡è®¡",
            q: "ç§Ÿèµæµ‹è¯•ï¼šåœ¨è´­ä¹°å‰ï¼Œä½ æ„¿æ„å…ˆèŠ±ç‚¹éº»çƒ¦å»ç§Ÿæˆ–è€…å€Ÿç”¨è¿™ä»¶ä¸œè¥¿ä¸€å‘¨å—ï¼Ÿ",
            theory: "æ­¤é—®é¢˜å¼•å…¥â€˜äº¤æ˜“æ‘©æ“¦â€™ã€‚å¦‚æœç”¨æˆ·è¿ç§Ÿèµçš„éº»çƒ¦éƒ½ä¸æ„¿æ‰¿æ‹…ï¼Œè¯´æ˜ä»–ä»¬æ¸´æœ›çš„æ˜¯â€˜è´­ä¹°çš„å¿«æ„Ÿâ€™è€Œéâ€˜ä½¿ç”¨æƒâ€™ã€‚",
            case: "GoProï¼šå¾ˆå¤šäººä¸ºæ»‘é›ªä¹°GoProï¼Œä¸€å¹´åªç”¨ä¸¤æ¬¡ã€‚å¦‚æœå…ˆç§Ÿï¼Œä¼šå‘ç°å‰ªè¾‘æç¹çï¼Œæ ¹æœ¬ä¸æƒ³ä¹°ã€‚",
            options: [
                { t: "A. æ„¿æ„/å·²è¯•ç”¨", s: 5 },
                { t: "B. ä¸æ„¿æ„ï¼Œå¤ªéº»çƒ¦", s: 0, critique: "å¦‚æœä½ è¿ç§Ÿä¸€å‘¨è¯•ç”¨çš„è€å¿ƒéƒ½æ²¡æœ‰ï¼Œè¯´æ˜ä½ æ ¹æœ¬ä¸åœ¨ä¹å®ƒå¥½ä¸å¥½ç”¨ï¼Œä½ åªæ˜¯æƒ³ä½“éªŒâ€˜åˆ·å¡-æ‹†å¿«é€’â€™é‚£15åˆ†é’Ÿçš„å¤šå·´èƒºé«˜æ½®ã€‚" }
            ]
        },
        {
            dim: "æ•ˆç”¨å®¡è®¡",
            q: "é¢‘ç‡å®¡åˆ¤ï¼šæœªæ¥ä¸€å¹´å†…ï¼Œä½ ä¼šç”¨è¶…è¿‡50æ¬¡å—ï¼Ÿå¦‚æœå°‘äº10æ¬¡ï¼Œå•æ¬¡æˆæœ¬èƒ½æ¥å—å—ï¼Ÿ",
            theory: "å¼ºåˆ¶è¿›è¡ŒCPUï¼ˆå•æ¬¡ä½¿ç”¨æˆæœ¬ï¼‰è®¡ç®—ã€‚å¯¹äºä½é¢‘é«˜ä»·ç‰©å“ï¼Œå…±äº«æˆ–ç§Ÿèµåœ¨ç»æµä¸Šæ°¸è¿œä¼˜äºè´­ä¹°ã€‚",
            case: "å®¶ç”¨è·‘æ­¥æœºï¼šç»å¤§å¤šæ•°æœ€ç»ˆæ²¦ä¸ºæ™¾è¡£æ¶ã€‚å…¶ä½¿ç”¨é¢‘ç‡è¿œä½äºé¢„æœŸï¼Œå åœ°æˆæœ¬æé«˜ã€‚",
            options: [
                { t: "A. é«˜é¢‘ä½¿ç”¨ (>50æ¬¡)", s: 5 },
                { t: "B. ä½é¢‘ (<10æ¬¡)", s: 0, critique: "è¿™ä»¶ä¸œè¥¿3000å—ï¼Œä½ å°±ç”¨ä¸€æ¬¡ã€‚è¿™3000å—æ˜¯é—¨ç¥¨è´¹å—ï¼Ÿç§Ÿä¸€ä»¶åªè¦300ï¼Œå‰©ä¸‹çš„2700æ‹¿å»åƒé¡¿å¥½çš„ä¸é¦™å—ï¼Ÿ" }
            ]
        },
        {
            dim: "æ•ˆç”¨å®¡è®¡",
            q: "30å¤©å†·é™æœŸï¼šè¿™ä¸ªè´­ä¹°å¿µå¤´æ˜¯ä»Šå¤©æ‰æœ‰çš„å—ï¼Ÿ",
            theory: "æƒ…ç»ªå…·æœ‰ç¬æ—¶æ€§ã€‚å»¶è¿Ÿæ»¡è¶³èƒ½æœ‰æ•ˆè¿‡æ»¤æ‰ç”±ç¯å¢ƒåˆºæ¿€ï¼ˆå¹¿å‘Šã€ä¿ƒé”€ï¼‰å¼•å‘çš„ä¼ªéœ€æ±‚ã€‚",
            case: "ç›´æ’­é—´å†²åŠ¨å•ï¼šå–Šç€â€˜æœ€å5å•â€™ï¼Œè„‘å­ä¸€çƒ­ä¸‹å•ç©ºæ°”ç‚¸é”…ã€‚å¼ºåˆ¶ç­‰30å¤©ï¼Œä½ ä¼šå‘ç°æ ¹æœ¬ä¸åšé¥­ã€‚",
            options: [
                { t: "A. å·²ç»æƒ³äº†å¾ˆä¹…", s: 5 },
                { t: "B. ä»Šå¤©åˆšè¢«ç§è‰", s: 0, critique: "ç°åœ¨çš„â€˜éä¹°ä¸å¯â€™ï¼Œå¤§æ¦‚ç‡æ˜¯å•†å®¶çš„è¥é”€è¯æœ¯ç»™ä½ ä¸‹çš„è›Šã€‚æ”¾30å¤©ï¼Œ90%çš„ä¸œè¥¿ä½ ä¼šè¿å®ƒä»¬å«ä»€ä¹ˆéƒ½æƒ³ä¸èµ·æ¥ã€‚" }
            ]
        },
        // --- ç»´åº¦äºŒï¼šè´¢åŠ¡ç°å® ---
        {
            dim: "è´¢åŠ¡ç°å®",
            q: "å·¥æ—¶æ¢ç®—ï¼šè¿™ä¸œè¥¿çš„ä»·æ ¼ï¼Œéœ€è¦ä½ å¿å—è€æ¿çš„åºŸè¯å¤šå°‘ä¸ªå°æ—¶æ‰èƒ½èµšå›æ¥ï¼Ÿ",
            theory: "å°†æŠ½è±¡çš„è´§å¸å…·è±¡åŒ–ä¸ºç—›è‹¦çš„åŠ³åŠ¨æ—¶é—´ã€‚åˆ©ç”¨â€˜æŸå¤±åŒæ¶â€™å¿ƒç†ï¼Œè®©æ”¯å‡ºç—›æ„Ÿæ›´çœŸå®ã€‚",
            case: "æœˆè–ª5kä¹°iPhone Proï¼šå”®ä»·1ä¸‡æ„å‘³ç€ä¸¤ä¸ªæœˆä¸åƒä¸å–çš„åŠ³åŠ¨ã€‚è¿™ç§ç½®æ¢èƒ½æµ‡ç­è´­ä¹°æ¬²ã€‚",
            options: [
                { t: "A. å€¼å¾—äº¤æ¢", s: 5 },
                { t: "B. çœ‹ç€å¿ƒç–¼", s: 0, critique: "ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¿™å‡ ä¸ªæœˆæ—©èµ·è´ªé»‘ã€æŒ¤åœ°é“ã€åŠ ç­ã€æŒ¨éª‚ï¼Œå…¨æ˜¯ä¸ºè¿™ä¸ªå•†å“æ‰“å·¥ã€‚å®ƒçœŸçš„é…å—ï¼Ÿ" }
            ]
        },
        {
            dim: "è´¢åŠ¡ç°å®",
            q: "åŒå€æ”¯ä»˜èƒ½åŠ›ï¼šå¦‚æœä¸åˆ†æœŸï¼Œä½ çš„ç°é‡‘æµèƒ½é©¬ä¸Šä¹°ä¸¤ä¸ªè¿™ç©æ„å„¿è€Œä¸å¿ƒç–¼å—ï¼Ÿ",
            theory: "æºè‡ªJay-Zç†è´¢åè¨€ã€‚æ£€æµ‹æµåŠ¨æ€§é£é™©ã€‚å¦‚æœä¹°ä¸€ä¸ªå°±æ‰è¥Ÿè§è‚˜ï¼Œè¯´æ˜å±äºè¿‡åº¦æ æ†ã€‚",
            case: "å¤§å­¦ç”Ÿä¹°å¥¢ä¾ˆå“é‹ï¼šä½¿ç”¨åˆ†æœŸã€‚è™½ç„¶æœˆä¾›è½»æ¾ï¼Œä½†æœªæ¥ä¸€å¹´çš„ç°é‡‘æµè¢«é”å®šï¼ŒæŠ—é£é™©èƒ½åŠ›å½’é›¶ã€‚",
            options: [
                { t: "A. è½»æ¾ä¹°ä¸¤ä¸ª", s: 5 },
                { t: "B. ä¹°ä¸€ä¸ªéƒ½è´¹åŠ²", s: 0, critique: "åˆ«è¢«åˆ†æœŸå…æ¯éª—äº†ã€‚å¦‚æœä¹°ä¸€ä¸ªéƒ½è¦ç²¾æ‰“ç»†ç®—ï¼Œè¯´æ˜ä½ æ˜¯ä¸ªç©·äººï¼Œè€Œè¿™æ˜¯å¯Œäººçš„ç©å…·ã€‚å¼ºè¡Œæ¶ˆè´¹åªä¼šè®©ä½ æ›´ç©·ã€‚" }
            ]
        },
        {
            dim: "è´¢åŠ¡ç°å®",
            q: "æœºä¼šæˆæœ¬ï¼šå¦‚æœæŠŠè¿™ç¬”é’±å®šæŠ•æŒ‡æ•°åŸºé‡‘ï¼Œ10å¹´åå®ƒä¼šå˜æˆå¤šå°‘é’±ï¼Ÿ",
            theory: "æ¶ˆè´¹æ˜¯å¤åˆ©çš„æ•Œäººã€‚å°†æ¶ˆè´¹é‡‘é¢è½¬åŒ–ä¸ºæ½œåœ¨çš„æŠ•èµ„æ”¶ç›Šï¼Œèƒ½æå‡å†³ç­–é—¨æ§›ã€‚",
            case: "æ±½è½¦é¦–ä»˜ vs è‚¡ç¥¨ï¼š20ä¸‡ä¹°è½¦5å¹´åå€¼8ä¸‡ï¼›20ä¸‡ä¹°è‹±ä¼Ÿè¾¾æˆ–æŒ‡æ•°ï¼Œ5å¹´åå¯èƒ½ç¿»å€ã€‚",
            options: [
                { t: "A. è¿˜æ˜¯å®ƒé‡è¦", s: 5 },
                { t: "B. å­˜é’±æ›´å¥½", s: 0, critique: "ä½ ä¹°çš„ä¸æ˜¯è¡¨ï¼Œä½ æ˜¯åœ¨æ¶ˆç­æœªæ¥å¯èƒ½å˜æˆçš„å…»è€é‡‘ã€‚å¦‚æœè¿™ä¸œè¥¿ä¸ä¿å€¼ï¼Œé‚£ä½ å°±æ˜¯åŒé‡äºæŸã€‚" }
            ]
        },
        {
            dim: "è´¢åŠ¡ç°å®",
            q: "æŠ˜æ—§æ¥å—åº¦ï¼šå¦‚æœå‡ºé—¨è½¬æ‰‹å°±æ‰“5æŠ˜ï¼Œè¿™ç¬”é’±â€˜è’¸å‘â€™äº†ä½ å¿ƒç–¼å—ï¼Ÿ",
            theory: "å¤šæ•°æ¶ˆè´¹å“å­˜åœ¨â€˜æŸ æª¬å¸‚åœºâ€™æ•ˆåº”ï¼Œç¦»æŸœå³è´¬å€¼ã€‚éœ€åœ¨å¿ƒç†ä¸Šé¢„é”€æ¯è¿™éƒ¨åˆ†ä»·å€¼ã€‚",
            case: "é’»æˆ’ vs é»„é‡‘ï¼šé’»æˆ’ä¹°å…¥3ä¸‡å›æ”¶3åƒã€‚é»„é‡‘ä¹°å…¥3ä¸‡å›æ”¶è¿˜æ˜¯3ä¸‡ã€‚",
            options: [
                { t: "A. ä¸å¿ƒç–¼/æ¶ˆè€—å“", s: 5 },
                { t: "B. å¿ƒç–¼/æŒ‡æœ›ä¿å€¼", s: 0, critique: "åˆ«è·Ÿæˆ‘è°ˆä»€ä¹ˆâ€˜ä¿å€¼â€™ã€‚é™¤éä½ ä¹°çš„æ˜¯é»„é‡‘æˆ–çˆ±é©¬ä»•BKCï¼Œå¦åˆ™è¿™ä¸œè¥¿å°±æ˜¯ä¸ªç¢é’æœºã€‚ä¹°å®ƒå°±æ˜¯ä¸ºäº†æ¶ˆè€—ï¼Œåˆ«æŒ‡æœ›å›è¡€ã€‚" }
            ]
        },
        {
            dim: "è´¢åŠ¡ç°å®",
            q: "ç°é‡‘äºŒé€‰ä¸€ï¼šå¦‚æœè¿™ä¸€å †ç°é‡‘æ”¾åœ¨å·¦æ‰‹ï¼Œè¿™ä¸œè¥¿æ”¾åœ¨å³æ‰‹ï¼Œåªèƒ½æ‹¿ä¸€æ ·ï¼Ÿ",
            theory: "æ¶ˆé™¤æ•°å­—æ”¯ä»˜çš„æŠ½è±¡æ„Ÿã€‚ç‰©ç†ç°é‡‘çš„è¯±æƒ‘åŠ›å¾€å¾€å¤§äºç‰©å“ã€‚",
            case: "å¹´ç»ˆå¥–ï¼šå‘5ä¸‡ç°é‡‘ï¼Œå¾ˆå¤šäººä¼šé€‰æ‹©å­˜èµ·æ¥æˆ–æ—…æ¸¸ï¼Œè€Œä¸æ˜¯æ¢æˆä¸€å—è¡¨ã€‚",
            options: [
                { t: "A. é€‰ä¸œè¥¿", s: 5 },
                { t: "B. é€‰ç°é‡‘", s: 0, critique: "çœ‹ç€é‚£ä¸€å åšåšçš„é’ç¥¨ï¼Œä½ å¯èƒ½çªç„¶è§‰å¾—ï¼Œæ—§æ‰‹æœºå…¶å®è¿˜æ²¡é‚£ä¹ˆå¡ï¼Œæ—§åŒ…åŒ…ä¹Ÿè¿˜èƒ½èƒŒã€‚" }
            ]
        },
        // --- ç»´åº¦ä¸‰ï¼šå¿ƒç†é™·é˜± ---
        {
            dim: "å¿ƒç†é™·é˜±",
            q: "ç‹„å¾·ç½—é¢„è­¦ï¼šä¹°äº†è¿™ä¸ªä¹‹åï¼Œä¸ºäº†é…å¾—ä¸Šå®ƒï¼Œä½ è¿˜éœ€è¦ä¹°å¤šå°‘å‘¨è¾¹é…ä»¶ï¼Ÿ",
            theory: "ç‹„å¾·ç½—æ•ˆåº”ã€‚ä¸ºäº†ä¿æŒç‰©å“é—´çš„ä¸€è‡´æ€§ï¼Œæ–°ç‰©å“å¾€å¾€è¿«ä½¿æ—§ç‰©å“è¢«æ·˜æ±°ã€‚",
            case: "éœ²è¥ï¼šåªä¹°äº†ä¸€é¡¶å¸ç¯·ï¼Œç»“æœå‘ç°éœ€è¦å¤©å¹•ã€è›‹å·æ¡Œã€è¥åœ°è½¦â€¦â€¦æœ€ç»ˆèŠ±è´¹æ˜¯å¸ç¯·çš„10å€ã€‚",
            options: [
                { t: "A. ä¸éœ€è¦é…ä»¶", s: 5 },
                { t: "B. éœ€è¦å¤§æ¢è¡€", s: 0, critique: "ä¸ºäº†è¿™ä¸€ç¢Ÿé†‹ï¼Œä½ å¾—åŒ…é¡¿é¥ºå­ï¼Œæœ€åç ´äº§çš„æ˜¯åŒ…é¥ºå­çš„ä½ ã€‚" }
            ]
        },
        {
            dim: "å¿ƒç†é™·é˜±",
            q: "ç¤¾äº¤éšèº«æµ‹è¯•ï¼šå¦‚æœè¿™ä¸œè¥¿å®Œå…¨æ²¡æœ‰Logoï¼Œä½ è¿˜ä¼šä¹°å—ï¼Ÿ",
            theory: "å‰¥ç¦»å‡¡å‹ƒä¼¦æ•ˆåº”ã€‚æµ‹è¯•ç‰©å“æ˜¯å…·æœ‰å†…åœ¨æ•ˆç”¨è¿˜æ˜¯ä»…ä¸ºç‚«è€€æ€§æ¶ˆè´¹ã€‚",
            case: "Supremeç –å¤´ï¼šä¸€å—å°Logoçš„çº¢ç –å–å‡ åƒã€‚å¦‚æœæ²¡æœ‰Logoï¼Œå®ƒä¸€æ–‡ä¸å€¼ã€‚",
            options: [
                { t: "A. ä¼šï¼Œçœ‹ä¸­åŠŸèƒ½", s: 5 },
                { t: "B. ä¸ä¼šäº†", s: 0, critique: "æ‰¿è®¤å§ï¼Œä½ æ ¹æœ¬ä¸åœ¨ä¹é¢æ–™ï¼Œä½ åªåœ¨ä¹é‚£ä¸ªLogoèƒ½è®©åŒäº‹é«˜çœ‹ä½ ä¸€çœ¼ã€‚ä½ æ˜¯ä¸ºäº†åˆ«äººçš„çœ¼å…‰ä¹°å•ï¼Œè¿™å«äº¤â€˜è‡ªå‘ç¨â€™ã€‚" }
            ]
        },
        {
            dim: "å¿ƒç†é™·é˜±",
            q: "HALTæƒ…ç»ªæ£€ä¿®ï¼šä½ ç°åœ¨æ˜¯ä¸æ˜¯é¥¿äº†ã€ç”Ÿæ°”ã€å­¤ç‹¬æˆ–è€…ç´¯äº†ï¼Ÿ",
            theory: "é›¶å”®ç–—æ³•ã€‚åœ¨è®¤çŸ¥èµ„æºè€—å°½æˆ–æƒ…ç»ªä½è½æ—¶ï¼Œå‰é¢å¶æ§åˆ¶åŠ›å‡å¼±ï¼Œæ›´å®¹æ˜“å†²åŠ¨æ¶ˆè´¹ã€‚",
            case: "æ·±å¤œç½‘è´­ï¼šæ™šä¸Š11ç‚¹æ„Ÿåˆ°å­¤ç‹¬ï¼Œç–¯ç‹‚ä¸‹å•ã€‚ç¬¬äºŒå¤©æ—©ä¸Šé†’æ¥é€šå¸¸ä¼šåæ‚”ã€‚",
            options: [
                { t: "A. æˆ‘å¾ˆæ¸…é†’", s: 5 },
                { t: "B. æ˜¯çš„ï¼ŒçŠ¶æ€ä¸å¥½", s: 0, critique: "ä½ ç°åœ¨ä¸æ˜¯åœ¨è´­ç‰©ï¼Œä½ æ˜¯åœ¨æ‰¾å¥¶å˜´ã€‚å»ç¡ä¸€è§‰ï¼Œå»åƒé¡¿ç«é”…ã€‚åˆ«ç”¨é’±åŒ…æ¥å¡«è¡¥æƒ…ç»ªçš„é»‘æ´ã€‚" }
            ]
        },
        {
            dim: "å¿ƒç†é™·é˜±",
            q: "å½±å“è€…å…ç–«ï¼šåœ¨æ‰“å¼€APPä¹‹å‰ï¼Œä½ çŸ¥é“è‡ªå·±â€˜éœ€è¦â€™è¿™ä¸ªä¸œè¥¿å—ï¼Ÿ",
            theory: "æ¨¡ä»¿æ¬²æœ›ã€‚æˆ‘ä»¬çš„æ¬²æœ›å¾€å¾€æ˜¯æ¨¡ä»¿ä»–äººçš„ç»“æœï¼Œè€Œéæºè‡ªçœŸå®éœ€æ±‚ã€‚",
            case: "å…‰è…¿ç¥å™¨ï¼šç½‘çº¢æ»¤é•œè½°ç‚¸ä¸‹ï¼Œæ‰€æœ‰äººéƒ½è§‰å¾—è‡ªå·±ç¼ºä¸€æ¡ï¼Œå®é™…ç©¿ä¸Šå¹¶ä¸è‡ªç„¶ã€‚",
            options: [
                { t: "A. æœ¬æ¥å°±éœ€è¦", s: 5 },
                { t: "B. è¢«ç§è‰çš„", s: 0, critique: "åšä¸»æ¨èæ˜¯å› ä¸ºæ”¶äº†å¹¿å‘Šè´¹ï¼Œä½ ä¹°æ˜¯å› ä¸ºä½ æ˜¯éŸ­èœã€‚å¥¹ç”¨è¿™ä¸ªæ˜¾å¾—ç²¾è‡´ï¼Œä½ ç”¨äº†åªèƒ½æ˜¾å¾—â€˜è·Ÿé£â€™ã€‚" }
            ]
        },
        {
            dim: "å¿ƒç†é™·é˜±",
            q: "äº«ä¹è·‘æ­¥æœºï¼šä¸‰ä¸ªæœˆåï¼Œè¿™ä¸œè¥¿è¿˜èƒ½è®©ä½ åƒä»Šå¤©è¿™ä¹ˆå…´å¥‹å—ï¼Ÿ",
            theory: "æƒ…æ„Ÿé¢„æµ‹åå·®ã€‚æˆ‘ä»¬å€¾å‘äºé«˜ä¼°æœªæ¥äº‹ä»¶å¯¹æƒ…ç»ªå½±å“çš„å¼ºåº¦å’ŒæŒç»­æ—¶é—´ã€‚",
            case: "Kindleï¼šä¹°çš„æ—¶å€™è§‰å¾—ä¼šåšè§ˆç¾¤ä¹¦ï¼Œä¸‰ä¸ªæœˆåå”¯ä¸€çš„ç”¨é€”æ˜¯ç›–æ³¡é¢ã€‚",
            options: [
                { t: "A. èƒ½ï¼Œé•¿ä¹…çˆ±å¥½", s: 5 },
                { t: "B. ä¸ç¡®å®š", s: 0, critique: "æ–°è½¦çš„å‘³é“åªèƒ½ç»´æŒä¸€ä¸ªæœˆï¼Œä½†è½¦è´·è¦è¿˜ä¸‰å¹´ã€‚ä¸‰ä¸ªæœˆåï¼Œå®ƒå°±ä¼šå˜æˆè§’è½é‡Œçš„ç°å°˜æ”¶é›†å™¨ã€‚" }
            ]
        },
        // --- ç»´åº¦å››ï¼šæŒæœ‰æˆæœ¬ ---
        {
            dim: "æŒæœ‰æˆæœ¬",
            q: "ç©ºé—´ç¨ï¼šä½ å®¶é‡Œæœ‰ä¸“é—¨ç©ºå‡ºæ¥çš„åœ°æ–¹æ”¾å®ƒå—ï¼ŸæŒ‰ç…§æˆ¿ä»·ç®—ï¼Œå åœ°å€¼å¤šå°‘é’±ï¼Ÿ",
            theory: "ç‰©ç†ç©ºé—´çš„ç»æµæˆæœ¬ä¸å¿ƒç†æ‹¥å µæˆæœ¬ã€‚æç®€ä¸»ä¹‰å¼ºè°ƒç‰©å“å¯¹ç©ºé—´çš„ä¾µå ã€‚",
            case: "å¤§å‹æŒ‰æ‘©æ¤…ï¼šå åœ°2å¹³ç±³ã€‚åœ¨ä¸€çº¿åŸå¸‚ä»·å€¼10ä¸‡+ã€‚æœ€åæ²¦ä¸ºå †è¡£æœçš„æ¤…å­ã€‚",
            options: [
                { t: "A. æœ‰åœ°æ–¹", s: 5 },
                { t: "B. æ²¡åœ°æ”¾", s: 0, critique: "ä½ èŠ±å‡ ç™¾ä¸‡ä¹°çš„æˆ¿å­ï¼Œæ˜¯ç”¨æ¥ä½äººçš„ï¼Œä¸æ˜¯ç”¨æ¥å †ç ´çƒ‚çš„ã€‚æ¯å¢åŠ ä¸€ä»¶æ‚ç‰©ï¼Œä½ çš„ç”Ÿæ´»ç©ºé—´å°±è´¬å€¼ä¸€åˆ†ã€‚" }
            ]
        },
        {
            dim: "æŒæœ‰æˆæœ¬",
            q: "ç»´æŠ¤æŠµæŠ¼ï¼šä½ å‡†å¤‡å¥½ä¾å€™å®ƒäº†å—ï¼Ÿ(å¹²æ´—ã€ä¿å…»ã€å……ç”µã€å‡çº§)",
            theory: "æ€»æ‹¥æœ‰æˆæœ¬(TCO)ã€‚æ˜¾æ€§ä»·æ ¼åªæ˜¯å†°å±±ä¸€è§’ï¼Œéšæ€§ç»´æŠ¤æˆæœ¬å¾€å¾€è¢«å¿½è§†ã€‚",
            case: "çœŸä¸è¡¬è¡«/ç¾Šçš®é‹ï¼šæå…¶éš¾æ‰“ç†ï¼Œç©¿ä¸€æ¬¡å°±è¦é€å¹²æ´—åº—ã€‚ç»´æŠ¤éº»çƒ¦å¯¼è‡´ä½é¢‘ä½¿ç”¨ã€‚",
            options: [
                { t: "A. å‡†å¤‡å¥½äº†", s: 5 },
                { t: "B. æŒºéº»çƒ¦çš„", s: 0, critique: "ä½ ä»¥ä¸ºä¹°çš„æ˜¯ä¸ªåŒ…ï¼Œå…¶å®ä¹°äº†ä¸ªâ€˜çˆ¹â€™ã€‚ä½ å¾—åƒä¾›ä½›ä¸€æ ·ä¾›ç€å®ƒï¼Œç´¯ä¸ç´¯ï¼Ÿ" }
            ]
        },
        {
            dim: "æŒæœ‰æˆæœ¬",
            q: "äºŒæ‰‹æ®‹å€¼ï¼šå¦‚æœä¸‹ä¸ªæœˆæ€¥éœ€ç”¨é’±ï¼Œè¿™ä¸œè¥¿å¥½å–å—ï¼Ÿ",
            theory: "èµ„äº§æµåŠ¨æ€§ã€‚å¥½çš„æ¶ˆè´¹å“åº”å½“å…·æœ‰ä¸€å®šçš„æµåŠ¨æ€§ã€‚",
            case: "è½»å¥¢åŒ…è¢‹ï¼šä¸“æŸœå‡ åƒä¹°å…¥ï¼ŒäºŒæ‰‹å¸‚åœºå‡ ç™¾å—éƒ½æ²¡äººè¦ã€‚æµåŠ¨æ€§æå·®ã€‚",
            options: [
                { t: "A. ç¡¬é€šè´§", s: 5 },
                { t: "B. ä¸å¥½å–", s: 0, critique: "åˆ«è·Ÿæˆ‘è¯´è¿™æ˜¯æŠ•èµ„ã€‚å½“ä½ æ€¥éœ€ç”¨é’±æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€å †æ— ç”¨çš„åºŸé“œçƒ‚é“ã€‚" }
            ]
        },
        {
            dim: "æŒæœ‰æˆæœ¬",
            q: "è¾¹é™…æ•ˆç”¨é™·é˜±ï¼šæ–°æ¬¾æ¯”æ—§æ¬¾çœŸçš„å¼ºå¾ˆå¤šå—ï¼Ÿ",
            theory: "éŸ¦ä¼¯-è´¹å¸Œçº³å®šå¾‹ã€‚å‚æ•°çš„æå‡å¾€å¾€æ„ŸçŸ¥ä¸å¼ºï¼Œä½†ä»·æ ¼å·®å¼‚å·¨å¤§ã€‚",
            case: "æ‰‹æœºå¹´å¹´æ¢ï¼šå¯¹äºåªåˆ·å¾®ä¿¡æŠ–éŸ³çš„ç”¨æˆ·ï¼ŒiPhone 13å’Œ15ä½“éªŒå·®å¼‚å¾®ä¹å…¶å¾®ã€‚",
            options: [
                { t: "A. è´¨çš„é£è·ƒ", s: 5 },
                { t: "B. å¾®å°å‡çº§", s: 0, critique: "ä¸ºäº†æå‡é‚£10%çš„æ€§èƒ½ï¼Œå¤šèŠ±100%çš„é’±ã€‚é™¤éä½ æ˜¯é è¿™ä¸ªåƒé¥­çš„ï¼Œå¦åˆ™å°±æ˜¯åœ¨ä¸ºå‚å®¶çš„è´¢æŠ¥åšæ…ˆå–„ã€‚" }
            ]
        },
        {
            dim: "æŒæœ‰æˆæœ¬",
            q: "ç¯ä¿è´Ÿç½ªæ„Ÿï¼šä¸æƒ³ç”¨å®ƒæ—¶ï¼Œå®ƒä¼šåœ¨åƒåœ¾åœºå­˜åœ¨å‡ ç™¾å¹´ã€‚å€¼å¾—å—ï¼Ÿ",
            theory: "ç¯å¢ƒå¿ƒç†å­¦ã€‚å°†æ¶ˆè´¹è¡Œä¸ºä¸ç¯å¢ƒåæœæŒ‚é’©ï¼Œé€šè¿‡é“å¾·å‹åŠ›æŠ‘åˆ¶å†²åŠ¨ã€‚",
            case: "ç›²ç›’/æ‰­è›‹ï¼šå¡‘æ–™åˆ¶å“çš„å¿«ä¹ä»…æŒç»­æ‹†å¼€çš„é‚£å‡ ç§’ï¼Œä¹‹åæ˜¯æ•°ç™¾å¹´çš„æ±¡æŸ“ã€‚",
            options: [
                { t: "A. èƒ½ç”¨å¾ˆä¹…", s: 5 },
                { t: "B. å¿«æ—¶å°š/å¡‘æ–™", s: 0, critique: "è¿™äº›å»‰ä»·çš„å¡‘æ–™ç©å…·ï¼Œæœ€ç»ˆéƒ½ä¼šå˜æˆå¾®å¡‘æ–™å›åˆ°ä½ çš„è‚šå­é‡Œã€‚å°‘ä¹°ç‚¹åƒåœ¾ï¼Œç§¯ç‚¹å¾·å§ã€‚" }
            ]
        }
    ];

    // === é€»è¾‘æ§åˆ¶ ===
    function startGame() {
        const salary = document.getElementById('monthlySalary').value;
        const price = document.getElementById('itemPrice').value;
        if (!salary || !price) { alert("è¯·å¡«å†™å…¥é—¨è´¹ï¼ˆæœˆè–ªå’Œä»·æ ¼ï¼‰ï¼"); return; }
        
        state.laborHours = (price / (salary / 21.75 / 8)).toFixed(1);
        document.getElementById('screen-setup').classList.remove('active');
        document.getElementById('screen-quiz').classList.add('active');
        renderQuestion();
    }

    function toggleKnowledge() {
        const content = document.getElementById('knowledge-content');
        const icon = document.getElementById('toggle-icon');
        content.classList.toggle('collapsed');
        
        // æ—‹è½¬å›¾æ ‡
        if (content.classList.contains('collapsed')) {
            icon.style.transform = 'rotate(180deg)';
        } else {
            icon.style.transform = 'rotate(0deg)';
        }
    }

    function renderQuestion() {
        const qData = questions[state.currentQ];
        document.getElementById('dimension-tag').innerText = qData.dim;
        document.getElementById('current-q-num').innerText = state.currentQ + 1;
        document.getElementById('progress-bar').style.width = `${(state.currentQ / questions.length) * 100}%`;
        document.getElementById('question-text').innerText = qData.q;
        
        // æ¸²æŸ“è¯¦æƒ…ä¸æ¡ˆä¾‹
        const kContent = document.getElementById('knowledge-content');
        kContent.innerHTML = `
            <div style="margin-bottom:8px;"><strong>ğŸ“– ç†è®ºï¼š</strong>${qData.theory}</div>
            <div><strong>ğŸ”¥ æ¡ˆä¾‹ï¼š</strong><span class="case-tag">Case</span>${qData.case}</div>
        `;
        // ç¡®ä¿æ–°é¢˜ç›®é»˜è®¤å±•å¼€ (ç§»é™¤ collapsed ç±»)
        kContent.classList.remove('collapsed');
        document.getElementById('toggle-icon').style.transform = 'rotate(0deg)';

        // æ¸²æŸ“é€‰é¡¹
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = '';
        qData.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'btn btn-option';
            btn.innerText = opt.t;
            btn.onclick = () => handleAnswer(opt);
            optContainer.appendChild(btn);
        });
    }

    function handleAnswer(opt) {
        state.answers.push({ ...questions[state.currentQ], choice: opt.t, score: opt.s, critique: opt.critique });
        state.score += opt.s;

        if (opt.s === 0 && opt.critique) {
            // è§¦å‘æ¯’èˆŒå¼¹çª—
            showOverlay(opt.critique);
        } else {
            // æ­£å‘åé¦ˆ
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 }, colors: ['#10B981', '#34D399'] });
            nextQuestion();
        }
    }

    function showOverlay(text) {
        document.getElementById('overlay-text').innerText = text;
        document.getElementById('critique-overlay').classList.add('active');
        // æ‰‹æœºéœ‡åŠ¨åé¦ˆ
        if (navigator.vibrate) navigator.vibrate(200);
    }

    function closeCritique() {
        document.getElementById('critique-overlay').classList.remove('active');
        nextQuestion();
    }

    function nextQuestion() {
        state.currentQ++;
        if (state.currentQ < questions.length) {
            setTimeout(renderQuestion, 300);
        } else {
            endGame();
        }
    }

    function endGame() {
        document.getElementById('screen-quiz').classList.remove('active');
        document.getElementById('screen-result').classList.add('active');
        
        const finalScore = state.score;
        const scoreEl = document.getElementById('final-score');
        const verdictEl = document.getElementById('final-verdict');
        const adviceEl = document.getElementById('final-advice');

        // è·‘åˆ†åŠ¨ç”»
        let temp = 0;
        const timer = setInterval(() => {
            temp++;
            scoreEl.innerText = temp;
            if (temp >= finalScore) clearInterval(timer);
            scoreEl.style.color = temp <= 40 ? "var(--danger)" : (temp <= 75 ? "var(--warning)" : "var(--primary)");
        }, 15);

        if (finalScore <= 40) {
            verdictEl.innerText = "ğŸ›‘ æ™ºå•†ç¨è­¦æŠ¥";
            verdictEl.style.color = "var(--danger)";
            adviceEl.innerHTML = "<strong>è¯Šæ–­ï¼š</strong> å¤šå·´èƒºåŠ«æŒçŠ¶æ€ã€‚ä½ çš„å¤§è„‘ç°åœ¨å…¨æ˜¯æ°´ã€‚<br><strong>å¤„æ–¹ï¼š</strong> ç«‹å³å…³é—­é¡µé¢ï¼å»ç¡ä¸€è§‰ã€‚";
        } else if (finalScore <= 75) {
            verdictEl.innerText = "âš ï¸ é«˜é£é™©åŒºåŸŸ";
            verdictEl.style.color = "var(--warning)";
            adviceEl.innerHTML = "<strong>è¯Šæ–­ï¼š</strong> å­˜åœ¨æ˜æ˜¾æ¶ˆè´¹é™·é˜±ã€‚<br><strong>å¤„æ–¹ï¼š</strong> æ”¾å…¥è´­ç‰©è½¦â€˜è…Œåˆ¶â€™30å¤©ã€‚å»ºè®®å¯»æ‰¾äºŒæ‰‹æ›¿ä»£ã€‚";
        } else {
            verdictEl.innerText = "âœ… ç†æ€§è®¤è¯é€šè¿‡";
            verdictEl.style.color = "var(--primary)";
            adviceEl.innerHTML = "<strong>è¯Šæ–­ï¼š</strong> ä¼˜è´¨èµ„äº§ã€‚è¿™å±äºä½ çš„èƒ½åŠ›åœˆå’Œåˆšéœ€ã€‚<br><strong>å¤„æ–¹ï¼š</strong> æ”¾å¿ƒè´­ä¹°ï¼Œä¸ç”¨æ„§ç–šã€‚";
        }
    }

    function downloadPDF() {
        const el = document.getElementById('pdf-content');
        document.getElementById('pdf-item').innerText = document.getElementById('itemName').value;
        document.getElementById('pdf-price').innerText = document.getElementById('itemPrice').value;
        document.getElementById('pdf-labor').innerText = state.laborHours;
        document.getElementById('pdf-score').innerText = state.score;
        document.getElementById('pdf-verdict-text').innerText = document.getElementById('final-verdict').innerText;
        document.getElementById('pdf-advice-text').innerHTML = document.getElementById('final-advice').innerHTML;

        const tbody = document.getElementById('pdf-table-body');
        tbody.innerHTML = '';
        state.answers.forEach(row => {
            const tr = document.createElement('tr');
            let answerText = `<b>${row.choice}</b>`;
            if (row.score === 0) answerText += `<br><i style="color:#EF4444; font-size:0.9em;">ğŸ¤¡ ${row.critique}</i>`;
            tr.innerHTML = `
                <td style="padding:8px; border-bottom:1px solid #eee;">${row.dim}</td>
                <td style="padding:8px; border-bottom:1px solid #eee;">${row.q}</td>
                <td style="padding:8px; border-bottom:1px solid #eee;">${answerText}</td>
            `;
            tbody.appendChild(tr);
        });

        el.classList.add('pdf-visible');
        html2pdf().from(el).save(`æ™ºå•†ç¨å®¡è®¡_${document.getElementById('itemName').value}.pdf`).then(() => el.classList.remove('pdf-visible'));
    }
</script>

</body>
</html>
